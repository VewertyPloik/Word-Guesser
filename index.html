<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Word Guesser</title>
<style>
body { font-family: sans-serif; background: #111; color: #eee; display: flex; flex-direction: column; align-items: center; margin: 0; }
h1 { margin-top: 20px; font-size: 28px; color: #ffcc00; text-shadow: 1px 1px 5px #000; }
#mode-selector { margin-top:10px; }
button { margin:5px; padding: 8px 12px; font-size: 16px; cursor: pointer; background: #ffcc00; border: none; border-radius: 5px; color: #111; font-weight: bold; }
#level-info, #daily-info, #four-info { margin-top: 10px; font-size: 20px; }
#game { margin-top: 20px; }
.row { display: flex; margin: 5px; }
.cell { width: 50px; height: 50px; margin: 3px; display: flex; justify-content: center; align-items: center; font-size: 24px; font-weight: bold; background: #333; border-radius: 8px; transition: transform 0.2s, background 0.2s; }
.cell.correct { background: #4caf50; color: white; transform: scale(1.1); }
.cell.present { background: #ff9800; color: white; transform: scale(1.1); }
.cell.absent { background: #555; color: white; }
input { margin-top: 20px; padding: 8px; font-size: 18px; width: 150px; text-transform: uppercase; }
#message { margin-top: 15px; font-size: 18px; min-height: 24px; }
#stats { margin-top: 10px; font-size: 16px; color: #ccc; }
#diamonds { margin-top: 10px; font-size: 18px; color: #00ffff; }
/* popup */
#popup, #letter-panel { display:none; position: fixed; top:50%; left:50%; transform: translate(-50%, -50%); background:#222; padding:20px; border-radius:10px; box-shadow:0 0 10px #000; color:#eee; text-align:center; }
#popup button, #letter-panel button { margin-top:10px; background:#ff4444; color:white; border:none; padding:5px 10px; border-radius:5px; cursor:pointer; }
#letter-panel h3 { margin-top:0; }
.letter-box { display:inline-block; margin:3px; padding:8px 10px; border-radius:5px; font-weight:bold; background:#333; color:#eee; }
.letter-green { background:#4caf50; color:#fff; }
.letter-yellow { background:#ff9800; color:#fff; }
.letter-gray { background:#555; color:#fff; }
</style>
</head>
<body>

<h1>Word Guesser</h1>

<div id="mode-selector">
  <button onclick="switchMode('levels')">50-Level Game</button>
  <button onclick="switchMode('daily')">Daily Word</button>
  <button onclick="unlockFourMode()">4-Letters Mode (25ðŸ’Ž)</button>
</div>

<div id="level-info"></div>
<div id="daily-info"></div>
<div id="four-info"></div>
<div id="game"></div>
<div>
  <input type="text" id="guess" maxlength="5" placeholder="Type your guess">
  <button onclick="submitGuess()">Guess</button>
  <button onclick="useHint()">Hint (5ðŸ’Ž)</button>
  <button onclick="resetProgress()">Reset Progress</button>
  <button onclick="openLetterPanel()">Letter Panel</button>
</div>
<div id="message"></div>
<div id="stats">Total Guesses: 0 | Best: -</div>
<div id="diamonds">ðŸ’Ž Diamonds: 0</div>

<div id="popup">
  <div id="popup-message"></div>
  <button onclick="closePopup()">X</button>
</div>

<div id="letter-panel">
  <h3>Letter Panel</h3>
  <div id="letters-grid"></div>
  <button onclick="closeLetterPanel()">Close</button>
</div>

<script>
// Levels words
const levels = [
  "FRIES","HOUSE","PLATE","DREAM","TRAIN","FIGHT","VIDEO","PUPPY","DRAFT","JUDGE",
  "LEASH","EARTH","MIGHT","WIRES","TREES","WATER","COULD","READY","SWORD","TREND",
  "WITCH","QUOTE","WORDS","CROWD","YOUNG","ZEBRA","ACORN","BLAZE","CHAIR","DELTA",
  "ELITE","FROST","GRAND","HURRY","INNER","JELLY","KNACK","LUNCH","MAGIC","NOBLE",
  "OCEAN","PLANT","QUERY","RIVAL","STONE","TRUST","USUAL","VALUE","WORST","YIELD"
];

// Daily words
const dailyWordsList = [
  "GRASS","ORDER","TARPS","DARTS","CANDY","LIGHT","SHARP","BRAVE","SWEET","PLAIN",
  "PRIDE","QUICK","STORM","BLOOM","CATCH","FANCY","HAPPY","JOKER","MARCH","PIXEL",
  "RANCH","SPOON","VIVID","WHALE","ALERT","BROWN","CRISP","DEALT","EAGLE","FRAIL",
  "GLASS","HEART","INDEX","LEMON","MOUNT","PRISM","TWEAK","VOUCH","WALTZ","YIELD"
];

// Four-letter words
const fourWords = [
  "TREE","GAME","LION","FISH","ROAD","MOON","FIRE","KING","SALT","WIND",
  "COOL","COLD","FAST","DARK","GOLD","LOVE","BIRD","BOOK","TIME","STAR"
];

function getDailyWordByDate(date){
  const start = new Date("2025-09-20");
  const today = new Date(date);
  let diff = Math.floor((today - start)/(1000*60*60*24));
  const index = diff % dailyWordsList.length;
  return dailyWordsList[index];
}

// Game state
let mode = localStorage.getItem('mode') || 'levels';
let stats = {
  levels: JSON.parse(localStorage.getItem('levelsStats')) || {total:0,best:null},
  daily: JSON.parse(localStorage.getItem('dailyStats')) || {total:0,best:null},
  four: JSON.parse(localStorage.getItem('fourStats')) || {total:0,best:null}
};
let diamonds = parseInt(localStorage.getItem('diamonds')) || 5;
let levelsCorrect = JSON.parse(localStorage.getItem('levelsCorrect')) || Array(50).fill(false);
let currentLevel = parseInt(localStorage.getItem('currentLevel')) || 0;
let guesses = 0;
let answer = '';
let letterStatus = {}; 
let fourUnlocked = JSON.parse(localStorage.getItem('fourUnlocked')) || false;

// Init all letters
function resetLetterStatus(){
  letterStatus={};
  for(let i=65;i<=90;i++) letterStatus[String.fromCharCode(i)]='default';
}

// Unlock 4-letter mode
function unlockFourMode(){
  if(fourUnlocked){ switchMode('four'); return; }
  if(diamonds<25){ alert("Not enough diamonds to unlock!"); return; }
  if(confirm("Unlock 4-Letters Mode for 25 diamonds?")){
    diamonds-=25;
    fourUnlocked=true;
    localStorage.setItem('fourUnlocked',true);
    updateDiamonds();
    switchMode('four');
  }
}

// Switch mode
function switchMode(m){
  mode = m;
  localStorage.setItem('mode',mode);
  guesses=0;
  resetLetterStatus();
  document.getElementById('game').innerHTML='';
  document.getElementById('message').innerText='';
  document.getElementById('guess').disabled = false;
  document.querySelector('button[onclick="submitGuess()"]').disabled = false;

  document.getElementById('level-info').innerText='';
  document.getElementById('daily-info').innerText='';
  document.getElementById('four-info').innerText='';

  if(mode==='levels'){ startLevel(currentLevel); }
  else if(mode==='daily'){ startDaily(); }
  else if(mode==='four'){ startFour(); }

  updateStats(); updateDiamonds();
}

// Start level
function startLevel(lvl){
  currentLevel = lvl;
  answer = levels[currentLevel];
  guesses=0;
  resetLetterStatus();
  document.getElementById('level-info').innerText=`Level ${currentLevel+1}`;
  document.getElementById('guess').maxLength=5;
  document.getElementById('guess').placeholder="Type your guess";
  updateStats(); saveState();
}

// Start daily
function startDaily(){
  const today = new Date();
  answer = getDailyWordByDate(today);
  guesses=0;
  resetLetterStatus();
  const options={year:'numeric',month:'long',day:'numeric'};
  const todayStr = today.toLocaleDateString(undefined,options);
  document.getElementById('daily-info').innerText=`Daily Word for ${todayStr}`;
  document.getElementById('guess').maxLength=5;
  document.getElementById('guess').placeholder="Type your guess";

  const lastDaily = localStorage.getItem('lastDailyPlay');
  const todayISO = today.toISOString().split("T")[0];
  if(lastDaily === todayISO){
    document.getElementById('message').innerText="You have already played today's word!";
    document.getElementById('guess').disabled = true;
    document.querySelector('button[onclick="submitGuess()"]').disabled = true;
  }
  updateStats(); updateDiamonds();
}

// Start 4-letter
function startFour(){
  answer = fourWords[Math.floor(Math.random()*fourWords.length)];
  guesses=0;
  resetLetterStatus();
  document.getElementById('four-info').innerText=`4-Letters Mode`;
  document.getElementById('guess').maxLength=4;
  document.getElementById('guess').placeholder="Type 4-letter word";
  updateStats(); saveState();
}

// Update stats + diamonds
function updateStats(){
  let s = mode==='levels'?stats.levels:mode==='daily'?stats.daily:stats.four;
  let best = s.best===null?'-':s.best;
  document.getElementById('stats').innerText=`Total Guesses: ${s.total} | Best: ${best}`;
}
function updateDiamonds(){
  document.getElementById('diamonds').innerText = `ðŸ’Ž Diamonds: ${diamonds}`;
  localStorage.setItem('diamonds',diamonds);
}

// Save state
function saveState(){
  localStorage.setItem('levelsStats',JSON.stringify(stats.levels));
  localStorage.setItem('dailyStats',JSON.stringify(stats.daily));
  localStorage.setItem('fourStats',JSON.stringify(stats.four));
  localStorage.setItem('levelsCorrect',JSON.stringify(levelsCorrect));
  localStorage.setItem('currentLevel',currentLevel);
  localStorage.setItem('mode',mode);
  localStorage.setItem('diamonds',diamonds);
  localStorage.setItem('fourUnlocked',fourUnlocked);
}

// Submit guess
function submitGuess(){
  const input = document.getElementById('guess');
  let guess = input.value.toUpperCase();
  if(guess.length!==answer.length){ alert(`Word must be ${answer.length} letters`); return; }

  guesses++;
  let s = mode==='levels'?stats.levels:mode==='daily'?stats.daily:stats.four;
  s.total++;
  updateStats();

  const row=document.createElement('div'); row.classList.add('row');
  let answerLetterCount={};
  for(let char of answer) answerLetterCount[char]=(answerLetterCount[char]||0)+1;

  let result=Array(answer.length).fill('absent');
  for(let i=0;i<answer.length;i++){ if(guess[i]===answer[i]){ result[i]='correct'; answerLetterCount[guess[i]]--; } }
  for(let i=0;i<answer.length;i++){ if(result[i]!=='correct' && answerLetterCount[guess[i]]>0){ result[i]='present'; answerLetterCount[guess[i]]--; } }
  for(let i=0;i<answer.length;i++){ 
    const cell=document.createElement('div'); 
    cell.classList.add('cell',result[i]); 
    cell.innerText=guess[i]; 
    row.appendChild(cell); 

    if(result[i]==='correct') letterStatus[guess[i]]='green';
    else if(result[i]==='present' && letterStatus[guess[i]]!=='green') letterStatus[guess[i]]='yellow';
    else if(result[i]==='absent' && letterStatus[guess[i]]==='default') letterStatus[guess[i]]='gray';
  }
  document.getElementById('game').appendChild(row);
  input.value='';

  if(guess===answer){
    let earned = Math.max(0, (answer.length+1)-guesses);
    diamonds += earned;
    if(s.best===null || guesses<s.best) s.best=guesses;
    updateStats(); updateDiamonds();

    if(mode==='levels'){
      levelsCorrect[currentLevel]=true;
      saveState();
      document.getElementById('message').innerText=`Correct! You earned ${earned} ðŸ’Ž. Moving on.`;
      if(currentLevel<49) setTimeout(()=>startLevel(currentLevel+1),1500);
      else document.getElementById('message').innerText="Congratulations! All 50 levels completed!";
    } else if(mode==='daily'){
      localStorage.setItem('lastDailyPlay', new Date().toISOString().split("T")[0]);
      saveState();
      document.getElementById('message').innerText=`Correct! You earned ${earned} ðŸ’Ž. See you tomorrow!`;
      document.getElementById('guess').disabled=true;
      document.querySelector('button[onclick="submitGuess()"]').disabled=true;
    } else {
      document.getElementById('message').innerText=`Correct! You earned ${earned} ðŸ’Ž. New word loaded!`;
      saveState();
      setTimeout(()=>startFour(),1500);
    }
  } else if(guesses>=5){
    showPopup(answer);
    if(mode==='daily'){ localStorage.setItem('lastDailyPlay', new Date().toISOString().split("T")[0]); }
    saveState();
  }
}

// Hints
function useHint(){
  if(diamonds<5){ alert("Not enough diamonds!"); return; }
  let pos = prompt(`Which letter do you want revealed? (1-${answer.length})`);
  if(!pos) return;
  pos = parseInt(pos);
  if(pos<1||pos>answer.length){ alert("Invalid position."); return; }
  diamonds -= 5;
  updateDiamonds();
  let letter = answer[pos-1];
  alert(`Letter ${pos} is: ${letter}`);
}

// Popup
function showPopup(word){
  document.getElementById('popup-message').innerText=`Failed! The word was: ${word}`;
  document.getElementById('popup').style.display='block';
}
function closePopup(){
  document.getElementById('popup').style.display='none';
  if(mode==='levels'){ if(currentLevel<49) startLevel(currentLevel+1); else document.getElementById('message').innerText="Game Over!"; }
  else if(mode==='four'){ startFour(); }
}

// Letter Panel
function openLetterPanel(){
  const grid=document.getElementById('letters-grid');
  grid.innerHTML='';
  for(let i=65;i<=90;i++){
    let letter=String.fromCharCode(i);
    let span=document.createElement('span');
    span.innerText=letter;
    span.classList.add('letter-box');
    if(letterStatus[letter]==='green') span.classList.add('letter-green');
    else if(letterStatus[letter]==='yellow') span.classList.add('letter-yellow');
    else if(letterStatus[letter]==='gray') span.classList.add('letter-gray');
    grid.appendChild(span);
  }
  document.getElementById('letter-panel').style.display='block';
}
function closeLetterPanel(){
  document.getElementById('letter-panel').style.display='none';
}

// Reset
function resetProgress(){
  if(confirm("Reset all progress?")){
    localStorage.clear();
    stats.levels={total:0,best:null};
    stats.daily={total:0,best:null};
    stats.four={total:0,best:null};
    diamonds=5;
    levelsCorrect=Array(50).fill(false);
    currentLevel=0;
    resetLetterStatus();
    fourUnlocked=false;
    if(mode==='levels') startLevel(0); 
    else if(mode==='daily') startDaily(); 
    else startFour();
    updateStats(); updateDiamonds();
  }
}

// Start
resetLetterStatus();
if(mode==='levels') switchMode('levels'); 
else if(mode==='daily') switchMode('daily'); 
else if(mode==='four' && fourUnlocked) switchMode('four'); 
else switchMode('levels');
</script>

</body>
</html>
